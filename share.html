<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分享 - 光影分享</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .share-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--gradient-dark);
            padding: 20px;
        }
        
        .share-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 40px;
            box-shadow: var(--shadow-xl);
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        
        .share-icon {
            font-size: 4rem;
            color: var(--accent-primary);
            margin-bottom: 20px;
        }
        
        .share-title {
            font-size: 2rem;
            margin-bottom: 12px;
            color: var(--text-primary);
        }
        
        .share-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .share-content {
            text-align: left;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .share-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: var(--radius-md);
            margin-bottom: 16px;
        }
        
        .share-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .share-btn.facebook {
            color: #1877f2;
        }
        
        .share-btn.twitter {
            color: #1da1f2;
        }
        
        .share-btn.whatsapp {
            color: #25d366;
        }
        
        .share-btn.telegram {
            color: #0088cc;
        }
        
        .share-link {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .share-link input {
            flex: 1;
        }
        
        .share-link button {
            white-space: nowrap;
        }
        
        .share-meta {
            color: var(--text-tertiary);
            font-size: 0.875rem;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <div class="share-container">
        <div class="share-card">
            <div class="share-icon">
                <i class="fas fa-share-alt"></i>
            </div>
            
            <h1 class="share-title" id="share-title">分享内容</h1>
            
            <p class="share-description" id="share-description">
                与他人分享这个精彩内容
            </p>
            
            <div class="share-content" id="share-content">
                <!-- 分享内容将通过JS动态生成 -->
            </div>
            
            <div class="share-actions">
                <button class="share-btn facebook" data-platform="facebook">
                    <i class="fab fa-facebook-f"></i>
                    <span>Facebook</span>
                </button>
                <button class="share-btn twitter" data-platform="twitter">
                    <i class="fab fa-twitter"></i>
                    <span>Twitter</span>
                </button>
                <button class="share-btn whatsapp" data-platform="whatsapp">
                    <i class="fab fa-whatsapp"></i>
                    <span>WhatsApp</span>
                </button>
                <button class="share-btn telegram" data-platform="telegram">
                    <i class="fab fa-telegram"></i>
                    <span>Telegram</span>
                </button>
            </div>
            
            <div class="share-link">
                <input type="text" id="share-url" readonly>
                <button class="btn btn-primary" id="copy-url-btn">
                    <i class="fas fa-copy"></i>
                    <span>复制</span>
                </button>
            </div>
            
            <button class="btn btn-outline btn-block" id="close-share-btn">
                <i class="fas fa-times"></i>
                <span>关闭</span>
            </button>
            
            <div class="share-meta">
                <p>分享链接将在30天后失效</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 获取URL参数
            const urlParams = new URLSearchParams(window.location.search);
            const type = urlParams.get('type');
            const id = urlParams.get('id');
            const title = urlParams.get('title') || decodeURIComponent(urlParams.get('title') || '');
            const text = urlParams.get('text') || decodeURIComponent(urlParams.get('text') || '');
            const url = urlParams.get('url') || window.location.origin;
            const image = urlParams.get('image');
            
            // 设置分享内容
            const shareTitle = document.getElementById('share-title');
            const shareDescription = document.getElementById('share-description');
            const shareContent = document.getElementById('share-content');
            const shareUrl = document.getElementById('share-url');
            
            let shareData = {
                title: title || '光影分享',
                text: text || '来看看这个精彩内容！',
                url: url,
                image: image
            };
            
            // 根据类型设置内容
            if (type === 'photo' && id) {
                shareData.title = title || '一张精彩照片';
                shareData.text = text || '我在光影分享发现了一张精彩照片！';
                shareData.url = `${window.location.origin}/?photo=${id}`;
                
                shareTitle.textContent = '分享照片';
                shareDescription.textContent = '与朋友分享这张精彩照片';
                
                shareContent.innerHTML = `
                    ${image ? `<img src="${image}" alt="${title}" class="share-image">` : ''}
                    <h3>${title || '精彩照片'}</h3>
                    ${text ? `<p>${text}</p>` : ''}
                `;
                
            } else if (type === 'profile' && id) {
                shareData.title = title || '用户资料';
                shareData.text = text || '来看看这个摄影师的精彩作品！';
                shareData.url = `${window.location.origin}/profile.html?user=${id}`;
                
                shareTitle.textContent = '分享用户资料';
                shareDescription.textContent = '与朋友分享这个摄影师的资料';
                
                shareContent.innerHTML = `
                    <h3>${title || '用户资料'}</h3>
                    ${text ? `<p>${text}</p>` : ''}
                `;
                
            } else {
                shareTitle.textContent = '分享内容';
                shareDescription.textContent = '与他人分享这个精彩内容';
                
                shareContent.innerHTML = `
                    <h3>${title || '光影分享'}</h3>
                    ${text ? `<p>${text}</p>` : ''}
                `;
            }
            
            // 设置分享链接
            shareUrl.value = shareData.url;
            
            // 绑定分享按钮事件
            document.querySelectorAll('.share-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const platform = e.currentTarget.dataset.platform;
                    shareToPlatform(platform, shareData);
                });
            });
            
            // 复制链接按钮
            document.getElementById('copy-url-btn').addEventListener('click', () => {
                copyToClipboard(shareData.url);
                showNotification('链接已复制到剪贴板', 'success');
            });
            
            // 关闭按钮
            document.getElementById('close-share-btn').addEventListener('click', () => {
                window.close();
            });
            
            // 分享到不同平台
            function shareToPlatform(platform, data) {
                let shareUrl = '';
                
                switch (platform) {
                    case 'facebook':
                        shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(data.url)}`;
                        break;
                    case 'twitter':
                        shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(data.text)}&url=${encodeURIComponent(data.url)}`;
                        break;
                    case 'whatsapp':
                        shareUrl = `https://wa.me/?text=${encodeURIComponent(data.text + ' ' + data.url)}`;
                        break;
                    case 'telegram':
                        shareUrl = `https://t.me/share/url?url=${encodeURIComponent(data.url)}&text=${encodeURIComponent(data.text)}`;
                        break;
                }
                
                if (shareUrl) {
                    window.open(shareUrl, '_blank', 'width=600,height=400');
                    showNotification(`正在分享到${getPlatformName(platform)}`, 'success');
                }
            }
            
            function getPlatformName(platform) {
                const names = {
                    'facebook': 'Facebook',
                    'twitter': 'Twitter',
                    'whatsapp': 'WhatsApp',
                    'telegram': 'Telegram'
                };
                return names[platform] || platform;
            }
            
            function copyToClipboard(text) {
                navigator.clipboard.writeText(text).then(() => {
                    return true;
                }).catch(() => {
                    // 备用方法
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    return true;
                });
            }
            
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.style.position = 'fixed';
                notification.style.top = '20px';
                notification.style.right = '20px';
                notification.style.zIndex = '1000';
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                    <div class="notification-content">
                        <h4>${type === 'success' ? '成功' : '提示'}</h4>
                        <p>${message}</p>
                    </div>
                `;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
        });
    </script>
</body>
</html>